# Правило SeDebugPrivilege_Enabled

Атака (SeDebugPrivilege_Enabled) является формой манипуляции доступом к системным ресурсам и привилегиям в Windows, и она включает в себя использование привилегии SeDebugPrivilege. Привилегия SeDebugPrivilege обычно предоставляется только системным администраторам и службам безопасности, и она позволяет доступ к процессам и ресурсам с более высокими привилегиями, чем у обычных пользователей.

## Методы атаки:

1. **Token Stealing (Кража токена):** Атакующий может использовать встроенные функции Windows API для копирования access tokens из существующих процессов. Это позволяет атакующему получить доступ к токенам других пользователей или системных процессов.

2. **Token Impersonation/Theft (Обман/Кража токена):** Скопированный access token может быть применен к существующему процессу (Token Impersonation) или использован для создания нового процесса (Create Process with Token). Это позволяет атакующему выполнить действия от имени другого пользователя или системного процесса.

3. **Приведение привилегий:** Атакующий может использовать украденный токен для повышения своего уровня привилегий, например, от уровня администратора к уровню SYSTEM. Это дает атакующему дополнительные права и возможности манипулировать системой.

## Цель атаки:

- Получение несанкционированного доступа к чужим данным и ресурсам.
- Маскировка своей активности под активность другого пользователя или системного процесса.
- Повышение уровня привилегий для выполнения опасных действий.

## Описание правила

Правило "SeDebugPrivilege_Enabled" отслеживает события, связанные с попытками изменения привилегий с помощью функции "AdjustTokenPrivileges" в операционной системе Windows.

- **key:**
    - "event_src.host", указывающего на хост, на котором произошло событие.

- **filter:**

    - `filter::NotFromCorrelator()`: Этот фильтр исключает события, созданные коррелятором.
    - `event_src.title == 'windows'`: Фильтруются события, связанные только с операционной системой Windows.
    - `msgid == '4703'`: Ожидаются события с определенным идентификатором сообщения (msgid), равным "4703".
    - `object.property == 'privileges'`: Фильтруется объект с атрибутом "privileges", что указывает на манипуляции с привилегиями.
    - `find_substr(lower(object.value), 'sedebugprivilege') != null`: Фильтр проверяет, что в значении атрибута "value" объекта содержится строка "sedebugprivilege" (привилегия SeDebugPrivilege).
