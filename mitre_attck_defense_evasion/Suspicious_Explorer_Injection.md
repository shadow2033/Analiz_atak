# Правило Suspicious Explorer Injection

Правило **Suspicious_Explorer_Injection** используется для обнаружения атак, при которых атакующие внедряют свой код в память процесса `explorer.exe` с целью эксплуатации и сокрытия своих действий. Эта атака попадает под категорию "Process Injection".

## Методы атаки:

1. **DLL Injection**: Атакующие могут внедрить свою библиотеку (DLL) в память процесса `explorer.exe`, что позволяет им выполнить свой код в контексте этого процесса. Это может быть достигнуто путем изменения системных путей для загрузки DLL или использования уязвимостей в самом `explorer.exe`.

2. **Remote Thread Injection**: Атакующие могут создать удаленный поток в процессе `explorer.exe` и внедрить свой код в этот поток. Это позволяет им выполнить код в контексте `explorer.exe` без необходимости изменять сам процесс.

3. **Process Hollowing**: Этот метод включает в себя создание нового процесса в памяти и замещение его кода кодом атакующего. Затем атакующий может выполнить этот новый процесс в контексте `explorer.exe`.

## Цель атаки:

- **Сокрытие действий**: Внедрение кода в процесс `explorer.exe` может помочь атакующим скрыть свои действия, так как `explorer.exe` является процессом оболочки Windows и часто запущен на большинстве систем.

- **Привилегии**: Внедрение кода в процесс `explorer.exe` может позволить атакующим выполнить код с привилегиями процесса `explorer.exe`, что может предоставить им доступ к ресурсам системы и сети.

- **Обход обнаружения**: Такие атаки могут обходить обнаружение средствами безопасности, так как выполнение кода происходит в контексте легитимного процесса.

## Описание правила

Правило "Suspicious_Explorer_Injection" может быть полезным для мониторинга и обнаружения потенциально злонамеренных действий, связанных с внедрением кода в процесс `explorer.exe`, что может быть частью атак или нежелательных действий в системе.

### Событие CreateRemoteThread

- **key:** Хост (компьютер), на котором произошло событие.
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Исключение событий, созданных из коррелятора.
  - `event_src.title == "sysmon"`: Условие проверяет, что событие является частью системного мониторинга Sysmon.
  - `msgid == "8"`: Условие проверяет, что идентификатор сообщения (msgid) события соответствует "8".
  - `subject.process.name != null`: Условие проверяет, что имя процесса (subject.process.name) не является пустым. Это может указывать на то, что процесс, вызвавший событие, имеет имя.
  - `match(lower(object.process.fullpath), "?:\windows\explorer.exe")`: Это условие проверяет, что путь к исполняемому файлу (fullpath) процесса (object.process) содержит строку "\windows\explorer.exe". То есть, это событие захватывает случаи, когда процесс с именем `explorer.exe` был запущен в системе.
