# Правило Parent PID Spoofing

Атака "Parent PID Spoofing" представляет собой технику, при которой злоумышленник пытается скрыть свои действия, изменяя или подделывая информацию о родительском процессе для своих вредоносных процессов. Обычно каждый процесс в операционной системе имеет свой идентификатор родительского процесса (Parent PID), который указывает на процесс, который создал данный процесс. Однако злоумышленники могут изменить этот идентификатор, чтобы осложнить обнаружение своих действий системой мониторинга и безопасности.

## Методы атаки:

1. **Скрытие от обнаружения:** Злоумышленники могут использовать Parent PID Spoofing для того, чтобы их вредоносный процесс выглядел как легитимный или нормальный процесс. Это может усложнить обнаружение атаки, так как системные инструменты и мониторинг могут не подозревать процесс, имитирующий нормальную активность.
2. **Уход от системного мониторинга:** Атакующие могут попытаться избежать обнаружения системными инструментами и антивирусами, подделывая информацию о родительском процессе, чтобы она не выглядела подозрительной.

**Цель атаки:** Целью атаки Parent PID Spoofing является обман операционной системы и мониторящих инструментов. Злоумышленники используют эту технику, чтобы:

- Скрыть свои вредоносные процессы среди легитимных процессов.
- Обойти мониторинг безопасности и системы обнаружения вторжений (IDS/IPS).
- Снизить вероятность обнаружения вредоносной активности.

## Описание правила

Правило "ParentPid_Spoofing", состоящее из двух событий ("Process_Start" и "Subrule_PPID_Spoofing"), предназначено для обнаружения потенциальных случаев поддельного идентификатора родительского процесса (PID Spoofing).

### Событие Process_Start:

- **key:** Ключ события формируется на основе нескольких параметров:
  - `event_src.host` - хост, на котором произошло событие.
  - `object.process.id` - идентификатор (PID) запущенного процесса.
  - `object.process.name` - имя запущенного процесса.
  - `object.process.parent.id` - идентификатор (PID) родительского процесса.
  - `object.process.parent.name` - имя родительского процесса.
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()` - исключение событий, созданных из коррелятора.
  - `filter::ProcessStart_Windows_any()` - фильтр, который применяется для событий запуска процессов на системах Windows.
  - `object.process.name != null и object.process.parent.name != null` - фильтры, которые проверяют, что имя запущенного процесса и имя его родительского процесса не пусты.

### Событие Subrule_PPID_Spoofing:

- **key:** Ключ события формируется на основе нескольких параметров:
  - `event_src.host` - хост, на котором произошло событие.
  - `object.process.id` - идентификатор (PID) процесса.
  - `object.process.name` - имя процесса.
  - `object.process.parent.id` - идентификатор (PID) родительского процесса.
  - `object.process.parent.name` - имя родительского процесса.
- **filter:** Условия фильтрации:
  - `correlation_name == "Subrule_ParentPid_Spoofing"` - этот фильтр указывает, что данное событие срабатывает только в случае с подделкой идентификаторов родительских процессов (Parent PID).
