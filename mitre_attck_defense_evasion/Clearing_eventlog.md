# Правило Clearing_eventlog

Атака "Indicator Removal: Clear Windows Event Logs" описывает действия злоумышленников, направленные на удаление следов их активности в системе путем очистки журналов событий Windows. Windows Event Logs представляют собой записи о событиях и уведомлениях компьютера, которые могут содержать информацию о действиях пользователя и состоянии системы. В Windows Event Logs существует три системно определенных источника событий: System, Application и Security, а также пять типов событий: Error, Warning, Information, Success Audit и Failure Audit.

## Методы атаки:

Злоумышленники могут выполнить удаление записей в журналах событий с помощью различных методов и утилит. В данном контексте упомянуты следующие команды для очистки журналов событий:

- `wevtutil cl system`: Очищает системный журнал событий.
- `wevtutil cl application`: Очищает журнал приложений.
- `wevtutil cl security`: Очищает журнал безопасности.

Злоумышленники также могут использовать другие механизмы для удаления записей из журналов событий, такие как графический интерфейс Event Viewer или PowerShell. Например, для удаления журнала безопасности и отключения логирования на будущее, злоумышленники могут использовать команду PowerShell `Remove-EventLog -LogName Security`.

**Цель атаки**:Целью атаки "Indicator Removal: Clear Windows Event Logs" заключается в стирании следов или устранении индикаторов, которые могли бы свидетельствовать об активности атакующей стороны в системе.

## Описание правила

Правило "Clearing_eventlog" фильтра событий, называемое "Clear_event," предназначено для обнаружения действий по очистке журналов событий в Windows.

### Событие Clear_event:

- **key:** Ключ события формируется на основе исходного хоста, на котором происходит событие.
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Исключает события, созданные коррелятором.
  - `event_src.title == "windows"`: События должны иметь заголовок "windows".
  - `action == "clean" и object == "log"`: Действие должно быть "clean" (очистка), и объект должен быть "log" (журнал событий).
  - Затем есть два условия, объединенных оператором OR:
    - `(lower(event_src.subsys) == "system" and msgid == "104")`: Если подсистема события - "system" и идентификатор сообщения (msgid) равен "104" (удаление записи из системного журнала).
    - `(lower(event_src.subsys) == "security" and msgid == "1102")`: Если подсистема события - "security" и идентификатор сообщения (msgid) равен "1102" (удаление записи из журнала безопасности).
