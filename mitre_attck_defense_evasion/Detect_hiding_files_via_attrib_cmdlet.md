# Атака "Detect_hiding_files_via_attrib_cmdlet"

Атака связана с попытками злоумышленников скрыть файлы и каталоги на компьютере для избежания обнаружения. При скрытии файлов или каталогов они не видны при нормальном просмотре файловой системы с помощью графического интерфейса или обычных команд в командной строке. Злоумышленники могут использовать такие методы скрытия для скрытия вредоносных файлов и директорий от обнаружения.

## Методы атаки:

1. **Windows:**
- В операционной системе Windows пользователи и злоумышленники могут скрыть файлы и каталоги с помощью утилиты `attrib.exe`. Например, команда `attrib +h <filename>` сделает файл скрытым.
- Для просмотра скрытых файлов в Windows, пользователю потребуется использовать ключи командной строки или настроить отображение скрытых файлов.

2. **Linux и macOS:**
- В Linux и macOS пользователи могут скрыть файлы и каталоги, начиная имя файла с точки ".". Например, файл `.hiddenfile` будет скрыт и не виден при использовании команды `ls` или в стандартных файловых менеджерах.
- В macOS существует также флаг `UF_HIDDEN`, который можно назначить файлам с помощью команды `chflags`. Этот флаг скрывает файлы в `Finder.app`, но они остаются видимыми в `Terminal.app`.

**Цель атаки:** Злоумышленники используют скрытые атрибуты для файлов и каталогов с целью обойти механизмы обнаружения и скрыть важную информацию.

## Описание правила

Правило "Detect_hiding_files_via_attrib_cmdlet" предназначено для обнаружения попыток скрытия файлов с использованием команды `attrib.exe` в операционной системе Windows.

### Событие event Process_Hiden_Start:

- **key:** Ключ события формируется на основе исходного хоста, на котором происходит событие.
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Исключает события, созданные коррелятором.
  - `msgid == "1"`: Проверяет, что значение `msgid` события равно "1".
  - `event_src.title == "sysmon"`: Проверяет, что событие связано с системой Sysmon.
  - `lower(object) == "process"`: Проверяет, что объектом события является процесс.
  - `lower(action) == "start"`: Проверяет, что действие, связанное с событием, - это запуск (старт) процесса.
  - `lower(object.process.name) == "attrib.exe"`: Это условие проверяет, что имя процесса (`object.process.name`) равно "attrib.exe".
  - `match(lower(object.process.cmdline), "attrib +h")`: Это условие использует регулярное выражение для проверки командной строки запущенного процесса. Оно ищет в командной строке фразу "attrib +h", что может указывать на попытку использования команды `attrib.exe` для скрытия файлов (например, "attrib +h file.txt").
