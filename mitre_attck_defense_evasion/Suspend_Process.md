# Правило Suspend_process

Атака Suspend_process представляет собой метод, при котором злоумышленники могут временно приостановить выполнение процесса (PROCESS_SUSPEND_RESUME) с целью внедрения в него вредоносного кода. Этот метод часто используется в техниках Process Injection, таких как Process Hollowing и Process Herpaderping, и представляет угрозу для безопасности системы.

## Методы атаки:

1. **Приостановка процесса**: Атакующие используют системный вызов NtSuspendProcess или аналогичные для остановки выполнения целевого процесса. Это делает процесс недоступным для выполнения и изменения его состояния.

2. **Внедрение кода**: После приостановки процесса, атакующие могут внедрить свой вредоносный код в адресное пространство процесса. Это позволяет им выполнять свой код в контексте процесса и скрывать свою активность среди легитимных процессов.

3. **Process Hollowing**: Атакующие могут создать новый процесс, а затем внедрить в него свой код, используя технику Process Hollowing. Это позволяет им скрыться от обнаружения, поскольку новый процесс может иметь легитимный вид.

4. **Process Herpaderping**: С использованием Process Herpaderping, атакующие могут изменить свой код или заголовок процесса после внедрения, что делает их активность менее заметной для системных средств мониторинга и антивирусных программ.

**Цель атаки:** Основной целью атаки "Suspend_process" является выполнение скрытой и вредоносной деятельности в рамках целевого процесса.

- Скрывать свою активность от обнаружения системами безопасности, включая антивирусные программы и системы мониторинга.
- Внедрить вредоносный код в легитимный процесс, чтобы уклониться от обнаружения и обходить средства защиты.

## Описание правила

Правило "Suspend_prpcess" наблюдает за событиями доступа к процессам в системе с использованием Sysmon (системного драйвера для мониторинга системных событий).

- **key:** Ключ формируется на основе хоста, на котором произошло событие.

- **filter:** Условия фильтрации :
  - `filter::NotFromCorrelator()`: Этот фильтр исключает события, созданные из коррелятора.
  - `msgid == "10"`: Фильтрует события по их идентификатору ("10").
  - `event_src.title == "sysmon"`: Уточняет, что события должны иметь заголовок "sysmon", что указывает на их происхождение из Sysmon.
  - `object.property == "GrantedAccess"`: Фильтрует события по свойству "GrantedAccess", что свидетельствует о предоставленном доступе.
  - `in_list(["0x800"], object.value) != null`: Проверяет, содержит ли значение свойства "object.value" значение "0x800". Если значение "0x800" присутствует, событие будет считаться соответствующим условиям.
