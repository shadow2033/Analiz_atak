# Правило RDP_settings_tampering

Атака "RDP_settings_tampering" представляет собой попытку изменения параметров настройки службы удаленного доступа (RDP) с целью получения несанкционированного доступа к системам удаленного рабочего стола. Эта атака может использоваться для обхода защиты, установки прокси-серверов или изменения правил доступа к RDP-серверу.

## Методы атаки:

1. **Злоумышленное изменение реестра:** Атакующие могут изменять параметры реестра, связанные с RDP, такие как порт службы, разрешенные пользователи, уровень шифрования и другие параметры конфигурации, чтобы открыть дополнительные доступы или уменьшить безопасность.

2. **Злоумышленная замена файлов конфигурации:** Атакующие могут заменить файлы конфигурации службы RDP на системе цели, что позволяет им изменить настройки безопасности и авторизации.

3. **Внедрение бэкдоров:** Злоумышленники могут внедрить бэкдоры или вредоносные программы в файлы или конфигурации службы RDP, чтобы обеспечить постоянный доступ к системе.

## Цель атаки:

- Получение несанкционированного доступа к системам удаленного рабочего стола.
- Установка скрытых точек входа для дальнейшего доступа.
- Обход сетевых исключений и правил доступа.
- Подрыв безопасности системы и конфиденциальности данных, находящихся в системе.

## Описание правила

Правило "RDP_settings_tampering" нацелено на мониторинг событий модификации данных в реестре, связанных с параметрами настройки службы удаленного доступа (RDP) на хосте.

### Событие Registry_Action:

- **key:** Ключ события формируется на основе двух параметров:
  - `event_src.host` - хост, на котором произошло событие.
  - `subject.process.name` - имя процесса, выполнившего действие в реестре.

- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Исключение событий, созданных из коррелятора.
  - `in_list(["13", 4657], msgid) != null`: Фильтрация по значению `msgid`, которое должно быть либо "13", либо "4657".
  - `in_list(["sysmon", "windows"], event_src.title) == True`: Фильтрация по `event_src.title`, где значение должно быть либо "sysmon", либо "windows".
  - `object == "reg_object"`: Событие должно иметь объект с именем "reg_object".
  - `action == "modify"`: Событие должно представлять модификацию (изменение) данных в реестре.
  - `find_substr(lower(object.path), "services\termservice") != null`: Условие ищет подстроку "services\termservice" в нижнем регистре пути объекта, указывая на изменение настроек, связанных с службой удаленного доступа.
  - `find_substr(lower(object.path), "\control\terminal server") != null`: Аналогично предыдущему условию, это условие ищет подстроку "\control\terminal server" в нижнем регистре пути объекта. Это связано с изменением параметров службы удаленного доступа.
  - `find_substr(lower(object.name), "servicedll") != null`: Это условие ищет подстроку "servicedll" в нижнем регистре имени объекта, что может быть связано с изменением параметров, связанных с библиотекой службы.
  - `find_substr(lower(object.name), "fdenytsconnections") != null`: Аналогично предыдущему условию, это условие ищет подстроку "fdenytsconnections" в нижнем регистре имени объекта, что может быть связано с настройками, регулирующими доступ к службе удаленного доступа.
  - `find_substr(lower(object.name), "enableconcurrentsessions") != null`: Аналогично остальным условиям, это условие ищет подстроку "enableconcurrentsessions" в нижнем регистре имени объекта, что может быть связано с настройками, разрешающими одновременные сессии для удаленного доступа.
  - `find_substr(lower(object.name), "portnumber") != null`: Аналогично остальным условиям, это условие ищет подстроку "portnumber" в нижнем регистре имени объекта, что может быть связано с настройками порта для удаленного доступа.
