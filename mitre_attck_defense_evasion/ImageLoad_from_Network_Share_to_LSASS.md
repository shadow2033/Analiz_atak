# Правило ImageLoad_from_Network_Share_to_LSASS

Атака описывает попытку удаленной инъекции динамической библиотеки (DLL) в процесс LSASS. Эта атака имеет серьезные последствия, поскольку LSASS отвечает за аутентификацию пользователей в системе Windows.

## Методы атаки

Злоумышленники пытаются внедрить вредоносную DLL в процесс LSASS с целью получения несанкционированного доступа к учетным данным и контролю над системой.


**Цель атаки** Злоумышленники пытаются внедрить вредоносную DLL в процесс LSASS с целью получить несанкционированный доступ к учетным данным, хранящимся в системе.

## Описание правила

Правило "ImageLoad_from_Network_Share_to_LSASS" предназначено для обнаружения событий, связанных с загрузкой неподписанных (несертифицированных) DLL-файлов в процесс LSASS.

### Событие "DLL_Load_NFSH"

- **key:** Ключ события формируется на основе исходного хоста, на котором происходит событие.

- **filter:** Условия фильтрации:

  - `filter::NotFromCorrelator()`: Исключает события, созданные коррелятором.
  - `event_src.title == "sysmon"`: Заголовок события равен "sysmon".
  - `msgid == "7"`: Учитывает только события с идентификатором "7", что, вероятно, связано с загрузкой DLL-файлов.
  - `(match(lower(subject.process.fullpath), "*:\\windows\\system32\\lsass.exe") or subject.process.name == "lsass.exe")`: Проверяет, если процесс, из которого происходит загрузка DLL, является процессом LSASS, который обычно находится в папке "C:\Windows\System32".
  - `regex(lower(object.process.fullpath), "^(\\)(\\[\w.-_]+){2,}(\\?)$", 0) != null`: Правило также применяется, если путь к процессу, из которого загружается DLL, соответствует регулярному выражению.
  - `(match(lower(object.process.name), ".dll") or match(lower(object.process.original_name), ".dll"))`: Правило также применяется, если имя процесса, из которого загружается DLL, или его исходное имя соответствует шаблону "*.dll".
  - `lower(object.value) == "not signed"`: Правило фильтрует только DLL-файлы, которые не подписаны (несертифицированы).
