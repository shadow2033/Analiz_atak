# Правило "Mimikatz_Memssp_Default_Log_Detected"

## mimilsa.log и его связь с Mimikatz

**Создание файла mimilsa.log:** Файл `mimilsa.log` создается инструментом Mimikatz в процессе его использования. Этот файл может содержать журнал операций, выполненных Mimikatz на целевой системе, включая получение учетных данных и выполнение атак.

**Содержание файла mimilsa.log:** Содержимое файла `mimilsa.log` зависит от того, какие команды и операции были выполнены с использованием Mimikatz на системе. Этот файл может содержать следующую информацию:
- Извлеченные учетные данные, такие как пароли, хэши и ключи.
- Детали о выполненных атаках, такие как атаки на Kerberos, NTLM и другие механизмы аутентификации.

## Описание правила

Правило "Mimikatz_Memssp_Default_Log_Detected" предназначено для обнаружения события, связанного с наличием файла журнала `mimilsa.log`, который может указывать на активность Mimikatz, конкретно на использование Mimikatz с параметром `-mimikatz`.

### Событие Mimilsa_log

Это событие связано с созданием файла на системе.

- **key:** Ключ события основан на исходном хосте, с которого произошло событие.
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Событие не должно быть отправлено коррелятором.
  - `filter::FileCreate_Windows()`: Событие создания файла должно быть связано с операционной системой Windows.
  - `lower(object.name) == "mimilsa.log"`: Имя объекта (файла) должно быть "mimilsa.log".
  - `lower(subject.process.name) == "lsass.exe"`: Имя процесса субъекта (subject.process.name) должно быть "lsass.exe", что указывает на процесс (Local Security Authority Subsystem Service).
