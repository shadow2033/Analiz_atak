# Правило Password Spraying

"Password spraying" - это вид атаки, при котором злоумышленник попытается получить доступ к системе, выполняя ограниченное количество попыток аутентификации с различными учетными записями, но с использованием ограниченного числа паролей (обычно несколько часто встречающихся паролей или словарь паролей). В отличие от брутфорса, где злоумышленник попытается все возможные комбинации паролей для одной учетной записи, здесь он пробует несколько паролей для множества учетных записей.

## Методы атаки:

1. Злоумышленник сначала выбирает несколько часто используемых паролей или создает словарь паролей.
2. Затем злоумышленник выбирает несколько целевых учетных записей.
3. Для каждой учетной записи злоумышленник выполняет попытку аутентификации с одним из выбранных паролей.
4. Попытки аутентификации выполняются медленно и осторожно, чтобы избежать блокировки учетных записей после нескольких неудачных попыток.

**Цель атаки**:Целью атаки "password spraying" является получение доступа к системе с использованием известных или легко предсказуемых паролей для нескольких учетных записей. Это может позволить злоумышленнику получить доступ к важным ресурсам или данным.

## Описание правила

Правило "Kerberos_pwd_spraying" используется для обнаружения потенциальных атак на систему методом "password spraying" с использованием протокола Kerberos.

### Событие Kerberos_Pre_Auth:

Это событие относится к протоколу Kerberos и обычно возникает при попытке аутентификации с использованием Kerberos до самой аутентификации (используется для обнаружения неудачных попыток входа в систему).

- **key:** Ключ события основан на исходном хосте, с которого произошла попытка аутентификации.
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Событие не должно быть отправлено коррелятором.
  - `event_src.title == "windows"`: Заголовок события должен быть равен "windows".
  - `event_src.subsys == "Security"`: Подсистема события должна быть "Security".
  - `msgid == "4771"`: Идентификатор сообщения события (msgid) должен быть равен "4771", что вероятно, соответствует неудачной попытке аутентификации.
  - `reason == "0x18"`: (reason) должна быть равной "0x18".
  - `not match(subject.account.name, "*$")`: Имя учетной записи субъекта (subject.account.name) не должно заканчиваться символом "$". Это используется для исключения компьютерных учетных записей (machine accounts) из анализа.
