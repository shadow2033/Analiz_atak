# Правило Dump_lsass_via_process_access

## Описание атаки
Атака "Dump_lsass_via_process_access" описывает попытку злоумышленников получить доступ к учетным данным, хранимым в памяти процесса LSASS. Этот процесс отвечает за управление учетными данными и аутентификацией в операционной системе Windows.

**Цель атаки:** Целью атаки является получение доступа к учетным данным, хранящимся в памяти процесса LSASS.

## Методы атаки

1. **Извлечение учетных данных из памяти LSASS:**
   - Злоумышленники могут использовать различные инструменты, такие как Mimikatz, для извлечения учетных данных, хранящихся в памяти LSASS. Это может включать в себя пароли, ключи и другую чувствительную информацию.

2. **Дамп памяти процесса LSASS:**
   - Злоумышленники могут создать дамп памяти процесса LSASS с целью анализа этой информации на локальной системе. Это позволяет им изучить учетные данные в более безопасной среде.

3. **Модификация реестра для добавления SSP (Security Support Provider):**
   - Злоумышленники могут изменить настройки реестра Windows, чтобы добавить новые SSP, что может позволить им получить доступ к учетным данным, включая пароли и PIN-коды, хранящимся в системе.

**Используемые SSP (Security Support Provider):**
Злоумышленники могут использовать различные SSP для доступа к учетным данным. Некоторые из них включают:

- **MSV (Microsoft Authentication Package):**
  - Используется для интерактивных входов в систему, пакетных входов и входов в службу.

- **Wdigest (Digest Authentication):**
  - Протокол дайджест-аутентификации предназначен для использования с обменами по протоколам HTTP (Hypertext Transfer Protocol) и Simple Authentication Security Layer (SASL).

- **Kerberos:**
  - Предпочтительно для взаимной проверки подлинности домена клиент-сервер в Windows 2000 и более поздних версиях.

- **CredSSP (Credential Security Support Provider):**
  - Обеспечивает единый вход и проверку подлинности на уровне сети для служб удаленных рабочих столов.

## Описание правила
Правило "Dump_lsass_via_process_access" предназначено для обнаружения попыток доступа к процессу lsass.exe и попыток доступа к объекту "lsass.exe" в системе. Такие попытки могут быть связаны с попытками получения доступа к защищенным данным в системе, включая учетные данные, хранящиеся в процессе lsass.exe.

**Событие AccessProcessLSASS:**

- **key:** Группирует события по хосту, на котором произошло событие.
- **filter:** Фильтр определяет, какие события будут учтены. В данном случае:
  - `filter::NotFromCorrelator()`: Убедитесь, что событие не было сгенерировано коррелятором.
  - `msgid == "10"`: Событие с соответствующим идентификатором сообщает о запуске процесса.
  - `event_src.title == "sysmon"`: Проверка, что событие связано с Sysmon.
  - `object.process.name == "lsass.exe"`: Отслеживается процесс с именем lsass.exe.
  - `in_list(["0x1010", "0x1fffff", "0x1410", "0x143a", "0x1438"], object.value)`: Проверяется, что значение (AccessMask) в событии содержится в списке заданных значений. Эти значения представляют разрешения на доступ к процессу lsass.exe.

**Событие AttemptAccessObject:**

- **key:** Группирует события по хосту, на котором произошло событие.
- **filter:** Фильтр определяет, какие события будут учтены. В данном случае:
  - `filter::NotFromCorrelator()`: Убедитесь, что событие не было сгенерировано коррелятором.
  - `msgid == "4663"`: Событие с соответствующим идентификатором сообщает о попытке доступа к файлу или объекту.
  - `event_src.subsys == "Security"`: Проверка, что событие связано с подсистемой безопасности.
  - `object.name == "lsass.exe"`: Проверяется, что объект с именем lsass.exe был целью доступа.
  - `in_list(["%%4484"], subject.account.privileges)`: Проверяется, что учетная запись субъекта имеет указанное привилегированное право ("%%4484").
