# Правило ProcDump

"ProcDump" - это атака, при которой злоумышленник использует утилиту ProcDump для создания дампа памяти процесса lsass. Процесс lsass отвечает за аутентификацию и управление учетными данными в системе Windows. Создание дампа памяти позволяет злоумышленнику анализировать его локально и извлекать учетные данные (логины и пароли) для доступа к системным ресурсам.

## Методы атаки:

1. Злоумышленник запускает инструмент ProcDump, указывая процесс lsass в качестве цели для создания дампа памяти.
2. ProcDump создает копию памяти процесса lsass и сохраняет ее в файл. Полученный файл дампа может содержать чувствительные учетные данные, такие как пароли.
3. Локальный анализ: Получив файл дампа памяти lsass, злоумышленники могут проводить локальный анализ этого файла, используя различные инструменты и методы.

**Цель атаки**:Целью атаки "ProcDump" является получение доступа к учетным данным, хранящимся в процессе lsass. Эти данные могут быть использованы для несанкционированного доступа к системным ресурсам и для выполнения привилегированных операций.

## Описание правила

Правило "LSASS_ProcDump" служит для обнаружения событий, связанных с попыткой создания дампа памяти процесса lsass.exe, что может указывать на попытку сбора учетных данных из памяти.

### Событие LSASS_Proccess_Access:

Это событие предназначено для обнаружения попыток доступа к процессу lsass.exe.

- **key:** Ключ события основан на хосте события и имени процесса субъекта (subject.process.name).
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Событие не должно быть отправлено коррелятором.
  - `event_src.title == "sysmon"`: Заголовок события должен быть равен "sysmon".
  - `msgid == "10"`: Идентификатор сообщения события (msgid) должен быть равен "10".
  - `lower(object.process.name) == "lsass.exe"`: Имя процесса объекта (object.process.name) должно быть равно "lsass.exe".
  - `find_substr(lower(subject.process.name),"procdump") != null`: Имя процесса субъекта (subject.process.name) должно содержать подстроку "procdump".

### Событие LSASS_Dump_Create:

Это событие предназначено для обнаружения попыток создания дампа памяти процесса lsass.exe.

- **key:** Ключ события также основан на хосте события и имени процесса субъекта (subject.process.name).
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Событие не должно быть отправлено коррелятором.
  - `event_src.title == "sysmon"`: Заголовок события должен быть равен "sysmon".
  - `msgid == "11"`: Идентификатор сообщения события (msgid) должен быть равен "11".
  - `regex(lower(object.name), ".lsass..dmp$", 0) != null`: Имя объекта (object.name) должно соответствовать шаблону, что указывает на файл дампа памяти lsass.exe.
