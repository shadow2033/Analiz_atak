# Credentials_MiniDumpWriteDump_Lsass

**Цель атаки:** Цель атаки состоит в получении учетных данных из памяти процесса LSASS, который отвечает за аутентификацию и управление учетными данными пользователей в операционной системе Windows.

## Методы атаки

1. **PowerShell:** Злоумышленники используют сценарий PowerShell для выполнения атаки. PowerShell является мощным инструментом, который позволяет выполнять различные операции в операционной системе Windows.
2. **MiniDumpWriteDump:** Злоумышленники используют функцию MiniDumpWriteDump для создания дампа памяти процесса LSASS. Эта функция позволяет сохранить содержимое памяти процесса в файл, что может включать в себя учетные данные и другую чувствительную информацию.

## Описание правила

Правило "Credentials_MiniDumpWriteDump_Lsass" разработано для обнаружения атак, связанных с получением учетных данных из памяти процесса LSASS при помощи сценария PowerShell, использующего функцию MiniDumpWriteDump.

### Событие "RunPowershellScript4104_MiniDump":

- **key:** Группирует события по хосту, на котором произошло событие.
- **filter:** Содержит условия, которые определяют, какие события должны быть сопоставлены этому правилу. В частности, фильтр учитывает:

  - `msgid == "4104"`: Соответствие определенного идентификатора сообщения.
  - `object == "command"`: Объект события - команда.
  - `event_src.title == "windows"`: Заголовок события - "windows".
  - `match(object.name, "*.ps1")`: Имя объекта (в данном случае, команды) должно соответствовать шаблону "*.ps1", что означает, что команда выполняется из сценария PowerShell.

### Проверки

Правило также включает проверки на наличие строк в командной строке процесса PowerShell, которые могут указывать на использование функции MiniDumpWriteDump и поиск процесса LSASS:

- `find_substr(lower(object.process.cmdline), "$minidumpwritedump")`
- `find_substr(lower(object.process.cmdline), "dump.invoke")`
- `find_substr(lower(object.process.cmdline), "minidump")`
- `find_substr(lower(object.process.cmdline), "get-process lsass")`


