# Правило "Mimikatz"

"Mimikatz" - это инструмент для извлечения паролей и другой конфиденциальной информации из систем Windows. Он часто используется в целях атаки и тестирования безопасности в системах Windows.

## Методы атаки:

1. **Извлечение паролей из LSASS:** Mimikatz может извлекать пароли, хранимые в памяти LSASS, включая локальные учетные записи, хеши паролей, а также учетные записи домена.

2. **Извлечение ключей сессии:** Mimikatz может извлекать ключи сессии, используемые для шифрования данных при аутентификации на системе.

3. **Pass-the-Hash (PtH) атаки:** Mimikatz позволяет использовать украденные хеши паролей для аутентификации в системе без фактического знания самих паролей.

**Цель атаки:** Целью атаки Mimikatz является извлечение конфиденциальной информации, такой как пароли, ключи шифрования и сессий, из систем Windows, особенно из памяти процесса LSASS, который хранит учетные данные пользователей.

## Описание правила

Правило "Mimikatz" предназначено для обнаружения запуска процесса Mimikatz или подозрительных действий, связанных с ним.

### Событие Process_Start:

Это событие относится к запуску процесса на системе.

- **key:** Ключ события основан на исходном хосте, с которого произошло событие.
- **filter:** Условия фильтрации:
  - `filter::NotFromCorrelator()`: Событие не должно быть отправлено коррелятором.
  - `filter::ProcessStart_Windows_any()`: Событие запуска процесса должно быть связано с операционной системой Windows.

        Здесь указываются несколько условий, при которых будет срабатывать правило для обнаружения Mimikatz:
        - `regex(lower(object.process.fullpath), ".mimikatz..exe$", 0) != null`: Если полный путь запускаемого процесса содержит "mimikatz.exe".
        - `regex(lower(object.process.meta), "\b(mimikatz|gentilkiwi|benjamin\s+delpy)\b", 0) != null`: Если метаданные процесса содержат ключевые слова, связанные с Mimikatz.
        - `lower(object.process.original_name) == "mimikatz.exe"`: Если имя запускаемого процесса точно соответствует "mimikatz.exe".
        - `regex(lower(object.process.cmdline), ".(privilege|crypto|sekurlsa|kerberos|lsadump|vault|token|misc|busylight|dpapi)::.", 0) != null`: Если командная строка запускаемого процесса содержит ключевые слова, связанные с различными функциями Mimikatz.
