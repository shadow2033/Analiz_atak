# Правило An_attempt_was_made_to_lsass_process

## Описание атаки

Атака описывает попытку злоумышленников получить доступ к учетным данным, хранимым в памяти процесса LSASS. Этот процесс отвечает за управление учетными данными и аутентификацией в операционной системе Windows.

**Цель атаки:** Получение доступа к учетным данным, хранящимся в памяти процесса LSASS.

**Методы атаки:**

1. **Извлечение учетных данных из памяти LSASS:** Злоумышленники могут использовать различные инструменты, такие как Mimikatz, для извлечения учетных данных, хранящихся в памяти LSASS. Это может включать в себя пароли, ключи и другую чувствительную информацию.

2. **Дамп памяти процесса LSASS:** Злоумышленники могут создать дамп памяти процесса LSASS с целью анализа этой информации на локальной системе. Это позволяет им изучить учетные данные в более безопасной среде.

3. **Модификация реестра для добавления SSP:** Злоумышленники могут изменить настройки реестра Windows, чтобы добавить новые SSP (Security Support Provider), что может позволить им получить доступ к учетным данным, включая пароли и PIN-коды, хранящимся в системе.

**Используемые SSP (Security Support Provider):**

Злоумышленники могут использовать различные SSP для доступа к учетным данным. Некоторые из них включают:

- **MSV:** интерактивные входы в систему, пакетные входы и входы в службу выполняются с помощью пакета проверки подлинности MSV.

- **Wdigest:** Протокол дайджест-аутентификации предназначен для использования с обменами по протоколам HTTP (Hypertext Transfer Protocol) и Simple Authentication Security Layer (SASL).

- **Kerberos:** предпочтительно для взаимной проверки подлинности домена клиент-сервер в Windows 2000 и более поздних версиях.

- **CredSSP:** обеспечивает единый вход и проверку подлинности на уровне сети для служб удаленных рабочих столов.

## Описание правила

Правило "An_attempt_was_made_to_lsass_process" создано для обнаружения попыток доступа к процессу LSASS, который в Windows отвечает за аутентификацию пользователей и обработку учетных данных. Правило оценивает события, связанные с запросами доступа к процессу LSASS.

Правило состоит из двух типов событий:

1. **Event RequestHandle:**

   Это событие активируется, когда происходит попытка обработать запрос к объекту (в данном случае, к процессу) в системе.

   - Событие не должно быть отправлено из коррелятора (NotFromCorrelator).
   - Заголовок события должен быть "windows."
   - Идентификатор сообщения (msgid) должен быть равен "4656" (событие обработки запроса).
   - Тип объекта (object.type) должен быть "process" (процесс).
   - Имя объекта (object.name) должно быть "lsass.exe" (процесс lsass.exe).
   - Имя процесса-инициатора (subject.process.name) не должно быть одним из ["avp.exe", "msmpeng.exe", "mrt.exe"].

2. **Event AccessObject:**

   Это событие активируется, когда происходит доступ к объекту (в данном случае, к процессу) в системе.

   - Событие не должно быть отправлено из коррелятора (NotFromCorrelator).
   - Событие может быть либо с заголовком "windows" и идентификатором сообщения "4663" (событие доступа к объекту), либо с заголовком "sysmon" и идентификатором сообщения "10" (событие Sysmon).
   - Имя объекта (object.name) или имя процесса-инициатора (subject.process.name) должно быть "lsass.exe" (процесс lsass.exe).
   - Имя процесса-инициатора (subject.process.name) не должно быть одним из ["avp.exe", "msmpeng.exe", "mrt.exe"].
