# Правило Chrome_firefox_opera_cred_read

**Цель атаки:** Злоумышленники стремятся получить доступ к учетным данным, которые пользователи сохраняют в веб-браузерах, такими как имена пользователей и пароли для веб-сайтов. Это делается для того, чтобы злоумышленники могли использовать эти учетные данные для несанкционированного доступа к аккаунтам пользователя.

## Методы атаки

1. **Извлечение из файлов:** Веб-браузеры обычно сохраняют учетные данные в зашифрованном формате в хранилище учетных данных. Однако злоумышленники могут использовать методы, такие как чтение базы данных веб-браузера и выполнение SQL-запросов для извлечения учетных данных. Например, в случае Google Chrome, они могут считать файл базы данных и выполнить SQL-запрос для получения имени пользователя и зашифрованного пароля.

2. **Использование Windows API:** Злоумышленники могут использовать Windows API для расшифровки полученных зашифрованных учетных данных. Они используют учетные данные жертвы, которые хранятся в кешированных данных входа, как ключ для расшифровки.

3. **Поиск в памяти процесса:** Злоумышленники также могут искать учетные данные, выполняя поиск в оперативной памяти процессов веб-браузеров на наличие узнаваемых паттернов, соответствующих учетным данным.

## Описание правила

Это правило "Chrome_firefox_opera_cred_read" предназначено для обнаружения попыток чтения учетных данных из файлов, связанных с веб-браузерами Chrome, Firefox и Opera на операционной системе Windows.

### События, на которые правило реагирует

Правило реагирует на следующие события чтения файлов:
- "Firefox_Login_Data_Files_Read" - событие чтения файлов, связанных с браузером Firefox.
- "Opera_Login_Data_Files_Read" - событие чтения файлов, связанных с браузером Opera.
- "Chrome_Login_Data_Read" - событие чтения файлов, связанных с браузером Google Chrome.

### Фильтры

Правило использует фильтры для выбора подходящих событий:
- `filter::NotFromCorrelator()` - исключение событий, созданных из коррелятора.
- `event_src.title == "windows"` - фильтр по типу операционной системы (Windows).
- `msgid == "4663"` - фильтр по идентификатору события чтения файла.
- `regex(lower(object.fullpath), "...")` - фильтр для определения пути к файлам, связанным с браузерами (Firefox, Opera, Chrome).
- `datafield5 == "0x1"` - фильтр по правам доступа (ReadData).
- `regex(lower(subject.process.fullpath), "...")` - фильтр, который исключает процессы из указанных директорий, чтобы избежать ложных срабатываний (False Positives).
