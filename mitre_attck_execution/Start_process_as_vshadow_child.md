# Правило Start_process_as_vshadow_child

Атака "Start_process_as_vshadow_child" предполагает злоупотребление утилитой командной строки Vshadow (vshadow.exe) для выполнения скриптов и команд с целью получения учетных данных (OS Credential Dumping) или обхода системных мер безопасности.

## Методы атаки:

1. **Использование Vshadow:** Злоумышленники могут использовать утилиту Vshadow для создания теневых копий томов, что позволяет им обойти системные меры безопасности и получить доступ к файлам и данным, к которым они обычно не имеют доступа. Vshadow предоставляет возможность выполнения команд и скриптов в контексте создания теневых копий.

2. **Злоупотребление привилегиями:** В случае успешной атаки злоумышленники могут получить привилегированный доступ к данным и учетным записям, что может привести к дампингу учетных данных операционной системы (OS Credential Dumping).

**Цель атаки:** Основной целью атаки является получение учетных данных, таких как пароли и ключи доступа, хранящиеся на целевой системе. Злоумышленники могут использовать эти учетные данные для последующих атак, проникновения в систему или несанкционированного доступа к данным.

## Описание правила

Правило "Start_process_as_vshadow_child" срабатывает на события запуска процессов (Process Start), когда родительским процессом является vshadow.exe. Правило предназначено для обнаружения событий запуска процессов, связанных с утилитой vshadow.exe.

### Событие Process_Start:

- **key:** Ключ события формируется на основе хоста.
- **filter:**
  - `filter::NotFromCorrelator()`: Исключает события, созданные коррелятором.
  - `in_list(["4688", "1"], msgid)`: Правило применяется к событиям с равным "4688" или "1", что означает события запуска процессов.
  - `in_list(["windows", "sysmon"], event_src.title)`: Фильтр проверяет, что имеет значение "windows" или "sysmon".
  - `lower(object) == "process"`: Правило фокусируется только на объектах типа "process", что соответствует запуску процессов.
  - `lower(action) == "start"`: Правило интересует только события запуска процессов, поэтому оно фильтрует только те события, где равно "start".
  - `lower(object.process.parent.name) == "vshadow.exe"`: Это ключевое условие, которое определяет родительский процесс vshadow.exe.
