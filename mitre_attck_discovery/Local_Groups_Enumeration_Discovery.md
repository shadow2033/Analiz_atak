# Правило Local_Groups_Enumeration_Discovery

Атака "Local_Groups_Enumeration_Discovery" направлена на получение информации о локальных группах и аккаунтах на целевой системе. Эта информация может быть использована злоумышленниками для определения наличия и имён локальных учётных записей, что в дальнейшем может помочь им при проведении последующих действий.

## Методы атаки

Злоумышленники могут использовать различные команды и утилиты для получения информации о локальных учётных записях и группах:

- **Windows**: На системах Windows, команды `net user` и `net localgroup` могут быть использованы для получения списка локальных пользователей и групп.
- **Linux**: На системах Linux, информацию о локальных пользователях и группах можно получить с помощью команды `getent passwd` и `getent group`, а также путём чтения файла `/etc/passwd`.
- **macOS**: На системах macOS, команда `dscl . list /Users` может быть использована для перечисления локальных аккаунтов.

**Цель атаки:** Основной целью атаки является сбор информации о локальных учётных записях и группах на целевой системе. Полученная информация может быть использована для последующих атак, таких как подбор паролей, повышение привилегий.

## Описание правила

Правило "Local_Groups_Enumeration_Discovery" относится к событию с кодом 4799. Оно используется для мониторинга действий, связанных с перечислением локальных групп на системе Windows.

### Key:

- **event_src.host**: Хост, на котором произошло событие.
- **subject.account.id**: Идентификатор учётной записи, совершившей действие (перечисление локальных групп).

### Filter:

- `filter::NotFromCorrelator()`: Исключает события, созданные коррелятором.
- `event_src.title == "windows"`: Ограничивает события только системами Windows.
- `msgid == "4799"`: Фильтрует события с кодом 4799, которые соответствуют перечислению локальных групп.
