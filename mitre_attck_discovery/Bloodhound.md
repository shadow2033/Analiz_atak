# Правило Bloodhound

Атака на использование утилиты BloodHound направлена на сбор и анализ данных в среде Active Directory или Azure с целью выявления привилегированных отношений и возможных атак. BloodHound представляет собой веб-приложение, использующее теорию графов для анализа и выявления скрытых и нежелательных связей в среде домена Active Directory или Azure.

## Методы атаки:

1. **Сбор данных:** Злоумышленники могут использовать BloodHound для сбора данных о структуре и привилегированных отношениях в среде Active Directory или Azure. Это включает в себя информацию о пользователях, группах, компьютерах, разрешениях и связях между ними.

2. **Анализ атак:** Злоумышленники могут использовать собранные данные для анализа возможных путей атаки и привилегированных учетных записей. BloodHound позволяет выявить сложные атаки, которые могли бы быть незаметными без такого инструмента.

3. **Планирование атак:** Злоумышленники могут использовать результаты анализа BloodHound для планирования и выполнения атак, направленных на получение дополнительных привилегий в среде Active Directory или Azure.

## Цель атаки:

Целью атаки на использование утилиты BloodHound может быть:

- Сбор информации о структуре среды Active Directory или Azure.
- Поиск и выявление атакованных учетных записей и объектов в среде.
- Планирование и выполнение атак для расширения привилегий.

## Описание правила

Правило "Bloodhound" предназначено для обнаружения событий доступа к удаленным IPC (Inter-Process Communication) ресурсам в среде Windows. IPC-ресурсы представляют собой механизм обмена данными и командами между процессами на удаленных компьютерах в сети.

### Событие IPC_Share_Access:

- **Key:**
  - event_src.host: Хост, с которого произошло событие.
  - src.ip: IP-адрес отправителя события.
  - src.port: Порт отправителя события.

- **Filter:**
  - filter::NotFromCorrelator(): Этот фильтр исключает события, созданные из коррелятора.
  - event_src.title == "windows": Фильтр, ограничивающий события только теми, которые связаны с операционной системой Windows.
  - msgid == "5145": Идентификатор сообщения, указывающий на тип события. В данном случае, это событие связано с доступом к ресурсу.
  - object.path == "\ipc$": Проверка пути ресурса, который должен быть "\ipc$\", что указывает на доступ к удаленному IPC-ресурсу.
  - in_list(["samr","lsarpc","srvsvc"], lower(object.name)): Фильтр, который ограничивает события только для определенных IPC-ресурсов, таких как "samr", "lsarpc" и "srvsvc". Эти ресурсы часто используются для удаленной аутентификации и управления системой.
  - regex(lower(subject.account.name), ".dc.$$", 0) == null: Этот фильтр исключает события, связанные с аккаунтами, имена которых соответствуют шаблону ".dc.$$". Этот шаблон, возможно, связан с аккаунтами контроллера домена (Domain Controller).
