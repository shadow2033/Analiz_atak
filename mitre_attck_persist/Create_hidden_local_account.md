#  Правило Create_hidden_local_account

Атака заключается в создании скрытой локальной учетной записи путем добавления знака доллара ($) к имени учетной записи. Это действие иногда выполняется злоумышленниками с целью увеличения доступа к системе и избежания обнаружения при просмотре учетных записей с использованием команды "net users".

## Методы атаки:

- **Скрытая учетная запись:** Злоумышленники добавляют знак доллара к имени учетной записи, например, "user$" вместо "user". Это приводит к тому, что учетная запись не отображается в обычном списке пользователей при использовании команды "net users".

## Цель атаки:

 - Создание скрытой локальной учетной записи позволяет злоумышленникам обойти обнаружение и получить дополнительный доступ к системе.
 - Зачастую, злоумышленники используют такие скрытые учетные записи для проведения дальнейших атак или для поддержания доступа к системе.

## Описание правила

Правило "Create_hidden_local_account" обнаружения событий, связанных с созданием учетных записей в реестре системы.

- **key:** Ключ формируется так же, как и в предыдущем правиле, на основе хоста, на котором произошло событие.
- **filter:** Фильтр события определяет следующие условия:
  - `filter::NotFromCorrelator()`: Исключение событий, созданных из коррелятора.
  - `msgid == "13" или msgid == "12" и event_src.title == "sysmon" или msgid == "4657" и event_src.title == "windows"`: Фильтр означает, что событие будет соответствовать этому правилу, если оно либо имеет равное "13" или "12" и равное "sysmon", либо имеет равное "4657" и равное "windows".
  - `object == "reg_object"`: Фильтр, который указывает, что объектом анализа является реестр (Registry).
  - `#\registry\machine\sam\sam\domains\account\users\names\hideme0007$`: Это строка, представляющая путь в реестре Windows, где хранятся учетные записи пользователей. В данном случае, учетная запись имеет имя "hideme0007" и символ доллара ($) добавлен в конец имени, что является характерным признаком скрытой учетной записи.
  - `match(lower(object.path), "\registry\machine\sam\sam\domains\account\users\names$")*`: Это условие, которое использует функцию для сравнения пути, представленного в нижнем регистре (функция преобразует строку в нижний регистр), с шаблоном пути. Здесь шаблон пути указывает на место хранения учетных записей пользователей в реестре и включает символ доллара ($) в конце. Таким образом, данное условие ищет события, где произошли изменения в реестре в пути, подходящем под этот шаблон.
